---
title: HTTPS协议
date: 2016-04-16
tags:
- HTTPS
---
<details>
<summary>点击展开目录</summary>
<!-- TOC -->

- [HTTPS](#https)

<!-- /TOC -->
</details>


## HTTPS

Https是身披SSL(Secure Socket Layer)外壳的Http,运行于SSL上,SSL运行于TCP之上,是添加了加密和认证机制的HTTP,具有了加密(防窃听), 认证(防伪装)和完整性保护(防篡改)特性.
SSL: Secure Socket Layer
TSL: Transport Layer Security,其前身是SSL

HTTPS协议的工作流程:
HTTPS在传输数据之前需要客户端(浏览器)与服务端(网站)之间进行一次握手,在握手过程中将确立双方加密传输数据的密码信息.
TLS/SSL协议不仅仅是一套加密传输的协议,TLS/SSL中使用了非对称加密,对称加密及HASH算法.

握手过程的简单描述如下:

1. 浏览器将自己支持的一套加密规则发送给网站.
2. 网站从中选出一组加密算法与HASH算法,并将自己的身份信息以证书的形式发回给浏览器.证书里面包含了网站地址,加密公钥,以及证书的颁发机构等信息.
3. 获得网站证书之后浏览器要做以下工作:
    1. 验证证书的合法性(颁发证书的机构是否合法,证书中包含的网站地址是否与正在访问的地址一致等),如果证书受信任,则浏览器栏里面会显示一个小锁头,否则会给出证书不受信的提示.
    2. 如果证书受信任,或者是用户接受了不受信的证书,浏览器会生成一串随机数的密码,并用证书中提供的公钥加密.
    3. 使用约定好的HASH计算握手消息,并使用生成的密码对消息进行加密,最后将之前生成的所有信息发送给网站.

4. 网站接收浏览器发来的数据之后要做以下的操作:
    1. 使用自己的私钥将信息解密取出密码,使用密码解密浏览器发来的握手消息,并验证HASH是否与浏览器发来的一致.
    2. 使用密码加密一段握手消息,发送给浏览器.

5. 浏览器解密并计算握手消息的HASH,如果与服务端发来的HASH一致,此时握手过程结束,之后所有的通信数据将由之前浏览器生成的随机密码并利用对称加密算法进行加密.

这里浏览器与网站互相发送加密的握手消息并验证,目的是为了保证双方都获得了一致的密码,并且可以正常的加密解密数据.
其中非对称加密算法用于在握手过程中加密生成的密码,对称加密算法用于对真正传输的数据进行加密,而HASH算法用于验证数据的完整性.
由于浏览器生成的密码是整个数据加密的关键,因此在传输的时候使用了非对称加密算法对其加密.

二者之间存在如下不同:
* 端口不同: Http与Http使用不同的连接方式,用的端口也不一样,前者是80,后者是443;
* 资源消耗: 和HTTP通信相比,Https通信会由于加解密处理消耗更多的CPU和内存资源;
* 开销: Https通信需要证书,而证书一般需要向认证机构购买;

> Https的加密机制是一种共享密钥加密和公开密钥加密并用的混合加密机制.




[![](https://static.segmentfault.com/v-5b1df2a7/global/img/creativecommons-cc.svg)](https://creativecommons.org/licenses/by-nc-nd/4.0/)
