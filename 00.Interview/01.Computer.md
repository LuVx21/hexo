---
title: 面试准备:计算机网络
date:
tags:
categories:
- 面试
---
<details>
<summary>点击展开目录</summary>
<!-- TOC -->

- [OSI网络体系结构与TCP/IP协议模型](#osi网络体系结构与tcpip协议模型)
- [端口](#端口)
- [应用层](#应用层)
    - [DHCP](#dhcp)
    - [DNS](#dns)
    - [FTP](#ftp)
    - [SMTP, IMAP, POP3](#smtp-imap-pop3)
    - [Http[s]](#https)
        - [Http](#http)
        - [Https](#https)
- [传输层](#传输层)
- [网络层](#网络层)
    - [IP](#ip)
    - [ARP](#arp)
    - [ICMP](#icmp)
        - [Traceroute](#traceroute)
    - [路由器](#路由器)
- [网络接口层](#网络接口层)
    - [数据链路层](#数据链路层)
    - [物理层](#物理层)
- [tips](#tips)
- [参考](#参考)

<!-- /TOC -->
</details>

# OSI网络体系结构与TCP/IP协议模型

![](https://gitee.com/LuVx/img/raw/master/osi.png)

OSI:Open System Interconnection(开放式系统互联)

| 层         | 说明                                                         |
| :--------- | :----------------------------------------------------------- |
| 应用层     | 允许访问OSI环境的手段(应用协议数据单元APDU)                  |
| 表示层     | 对数据进行翻译, 加密和压缩(表示协议数据单元PPDU)             |
| 会话层     | 建立, 管理和终止会话(会话协议数据单元SPDU)                   |
| 传输层     | 提供端到端的可靠报文传递和错误恢复(段Segment), 主机间的逻辑通信<br/>提供可靠的透明数据传输, 使上层服务用户不必关心通信子网的实现细节, 应用进程间的逻辑通信 |
| 网络层     | 负责数据包从源到宿的传递和网际互连(包PackeT), 主机间的逻辑通信 |
| 数据链路层 | 将比特组装成帧和点到点的传递(帧Frame)                        |
| 物理层     | 通过媒介传输比特, 确定机械及电气规范(比特Bit)                 |

# 端口

| port  | service              | port  | service           |
| :---- | :------------------- | :---- | :---------------- |
| 21    | ftp                  | 22    | ssh               |
| 23    | telnet(远程登录服务) | 25    | SMTP              |
| 53    | DNS域名服务          | 80    | http              |
| 110   | POP3                 | 443   | https             |
| 1080  | scokets              | 1521  | Oracle数据库服务  |
| 2181  | zookeeper服务端口    | 3306  | MySQL数据库服务   |
| 6379  | Redis数据库服务      | 5672  | rabbitmq 服务端口 |
| 8080  | web服务器常用        |       |                   |
| 15672 | rabbitmq 管理插件    | 20880 | dubbo 协议        |


# 应用层

| 协议   | 名称               | 端口号  | 传输层协议 | 备注                        |
| :----- | :----------------- | :------ | :--------- | :-------------------------- |
| DNS    | 域名解析系统       | 53      | UDP/TCP    | 长度超过 512 字节时使用 TCP |
| DHCP   | 动态主机配置协议   | 67/68   | UDP        | 域名解析                    |
| SNMP   | 简单网络管理协议   | 161/162 | UDP        | 用于管理网络设备            |
| FTP    | 文件传输协议       | 20/21   | TCP        | 控制连接 21, 数据连接 20     |
| TFTP   | 简单文件传输协议   | 69      | UDP        |                             |
| TELNET | 远程终端协议       | 23      | TCP        |                             |
| HTTP   | 超文本传送协议     | 80      | TCP        |                             |
| HTTPS  | 超文本传输安全协议 | 443     | TCP/TSL    |                             |
| SMTP   | 简单邮件传输协议   | 25      | TCP        |                             |
| IMAP   | 网际报文存取协议   | 143     | TCP        |                             |
| POP3   | 邮件读取协议       | 110     | TCP        |                             |

P2P:点对点传输

## DHCP

`Dynamic Host Configuration Protocol`: 动态主机配置协议, 提供了即插即用的连网方式, 用户不再需要去手动配置 IP 地址等信息.
DHCP 配置的内容不仅是 IP 地址, 还包括子网掩码, 默认路由器 IP 地址, 域名服务器的 IP 地址.
工作方式如下:

需要 IP 地址的主机广播发送 DHCP 发现报文(将目的地址置为全 1, 即 255.255.255.255:67, 源地址设置为全 0, 即 0.0.0.0:68),
DHCP 服务器收到发现报文之后, 则在 IP 地址池中取一个地址, 发送 DHCP 提供报文给该主机.

1. 发现阶段(DHCP客户端在网络中广播发送`DHCP DISCOVER`请求报文, 发现DHCP服务器, 请求IP地址租约)
2. 提供阶段(DHCP服务器通过`DHCP OFFER`报文向DHCP客户端提供IP地址预分配)
3. 选择阶段(DHCP客户端通过`DHCP REQUEST`报文确认选择第一个DHCP服务器为它提供IP地址自动分配服务)
4. 确认阶段(被选择的DHCP服务器通过`DHCP ACK`报文把在`DHCP OFFER`报文中准备的IP地址租约给对应DHCP客户端)

## DNS

`Domain Name System`: 域名系统

* 主机向本地域名服务器解析的过程采用递归
* 本地域名服务器向其它域名服务器解析可以使用递归和迭代两种方式.
    * 迭代的方式下, 本地域名服务器向一个域名服务器解析请求解析之后, 结果返回到本地域名服务器, 然后本地域名服务器继续向其它域名服务器请求解析;
    * 递归的方式下, 结果不是直接返回的, 而是继续向前请求解析, 最后的结果才会返回.

> DNS 在解析的过程使用 UDP 进行传输, 因为 UDP 最大只支持 512 字节的数据, 如果超过的话就需要使用 TCP 传输.

## FTP

FTP 在传输层使用 TCP, 并且需要建立两个并行的 TCP 连接: 控制连接和数据连接.
控制连接在整个会话期间一直保持打开, 而数据连接在数据传送完毕之后就关闭.前者使用端口21, 后者使用端口20.

## SMTP, IMAP, POP3

SMTP: Simple Mail Transfer Protocol, 简单邮件传输协议
IMAP: Internet Message Access Protocol, 因特网信息访问协议
POP3: “Post Office Protocol, 邮局协议版本3

一个电子邮件系统由三部分组成: 用户代理, 邮件服务器以及邮件发送协议和读取协议.其中发送协议常用 SMTP, 读取协议常用 POP3 和 IMAP.

## Http[s]

### Http

Http协议运行在TCP之上, 明文传输, 客户端与服务器端都无法验证对方的身份;

### Https

[http](../01.CS/HTTP.md)

# 传输层

![](https://gitee.com/LuVx/img/raw/master/protocol.jpg)

HTTP是应用层协议, 其传输都是被包装成TCP协议传输, 可以用SOCKET实现HTTP,

[TCP/UDP](../01.CS/01.TCP&UDP.md)

# 网络层

* IP(Internet Protocol): 网络协议
* ARP(Address Resolution Protocol): 地址解析协议
* ICMP(Internet Control Message Protocol): 网际控制报文协议
* IGMP(Internet Group Management Protocol): 网际组管理协议
* RARP(Reverse Address Resolution Protocol): 反向地址转换协议
* BOOTP(Bootstrap Protocol): 引导程序协议, DHCP协议的前身

## IP

IP: 不可靠协议,不会重复,使用ICMP协议通知失败

A, B, C是基本类, D, E类作为多播和保留使用, 为特殊地址

每个IP地址包括两个标识码(ID), 即网络ID和主机ID

同一个物理网络上的所有主机都使用同一个网络ID, 网络上的一个主机(包括网络上工作站, 服务器和路由器等)有一个主机ID与其对应,

IP地址长度为32位, 分为4组书写, 以`.`分割, 每组8位, 同时遵守一定的规则, 如`192.168.1.1`.

A~E类地址的特点如下:

* A类地址:网络id8位, 以0开头, 第一组范围:0~127
* B类地址:网络id16位, 以10开头, 第一组范围:128~191
* C类地址:网络id24位, 以110开头, 第一组范围:192~223
* D类地址:以1110开头, 第一组范围为224~239, 多播地址
* E类地址:以1111开头, 保留地址

> 以xx开头是指第一组的二进制表示形式
保留地址:

A类:10.0.0.0 - 10.255.255.255
B类:172.16.0.0 - 172.31.255.255
C类:192.168.0.0 - 192.168.255.255

> IPv6 : 采用128bit, 首部固定部分为40字节

## ARP

ARP(Address Resolution Protocol): 地址解析协议, 完成了IP地址与物理地址的映射

IP地址是网络层和以上各层使用的地址, 是一种逻辑地址, 物理地址是数据链路层和物理层使用的地址.

ARP协议用于IP地址与物理地址的对应

1. 首先每个主机都会在自己的ARP缓冲区中建立一个ARP列表, 以表示IP地址和MAC地址之间的对应关系.
2. 当源主机要发送数据时, 首先检查ARP列表中是否有对应IP地址的目的主机的MAC地址, 如果有, 则直接发送数据, 如果没有, 就向本网段的所有主机发送ARP数据包, 该数据包包括的内容有: 源主机 IP地址, 源主机MAC地址, 目的主机的IP 地址.
3. 当本网络的所有主机收到该ARP数据包时, 首先检查数据包中的IP地址是否是自己的IP地址, 如果不是, 则忽略该数据包, 如果是, 则首先从数据包中取出源主机的IP和MAC地址写入到ARP列表中, 如果已经存在, 则覆盖, 然后将自己的MAC地址写入ARP响应包中, 告诉源主机自己是它想要找的MAC地址.
4. 源主机收到ARP响应包后. 将目的主机的IP和MAC地址写入ARP列表, 并利用此信息发送数据. 如果源主机一直没有收到ARP响应数据包, 表示ARP查询失败.

> 广播发送ARP请求, 单播发送ARP响应.

## ICMP

Internet Control Message Protocol: Internet控制报文协议

ICMP 是为了更有效地转发 IP 数据报和提高交付成功的机会.它封装在 IP 数据报中, 但是不属于高层协议
ICMP 报文分为差错报告报文和询问报文.

ping 是 ICMP 的一个重要应用, 主要用来测试两台主机之间的连通性.
ping 发送的 IP 数据报封装的是无法交付的 UDP 用户数据报.

### Traceroute

Traceroute 是 ICMP 的另一个应用, 用来跟踪一个分组从源点到终点的路径

1. 源主机向目的主机发送一连串的 IP 数据报.第一个数据报 P1 的生存时间 TTL 设置为 1, 但 P1 到达路径上的第一个路由器 R1 时, R1 收下它并把 TTL 减 1, 此时 TTL 等于 0, R1 就把 P1 丢弃, 并向源主机发送一个 ICMP 时间超过差错报告报文;
2. 源主机接着发送第二个数据报 P2, 并把 TTL 设置为 2. P2 先到达 R1, R1 收下后把 TTL 减 1 再转发给 R2, R2 收下后也把 TTL 减 1, 由于此时 TTL 等于 0, R2 就丢弃 P2, 并向源主机发送一个 ICMP 时间超过差错报文.
3. 不断执行这样的步骤, 直到最后一个数据报刚刚到达目的主机, 主机不转发数据报, 也不把 TTL 值减 1.但是因为数据报封装的是无法交付的 UDP, 因此目的主机要向源主机发送 ICMP 终点不可达差错报告报文.
4. 之后源主机知道了到达目的主机所经过的路由器 IP 地址以及到达每个路由器的往返时间.


## 路由器


路由选择和分组转发

内部网关协议 IGP(Interior Gateway Protocol): 在 AS 内部使用, 如 RIP 和 OSPF.
外部网关协议 EGP(External Gateway Protocol): 在 AS 之间使用, 如 BGP.

RIP(路由信息协议)
OSPF(开放最短路径优先)
BGP:Border Gateway Protocol(边界网关协议)

> AS:自治系统

<!--
TCP三次握手数据丢失了怎么办?那如果后面又找到了呢?
OSI七层模型, 每层都说下自己的理解和知道的, 说的越多越好;
Server遭遇SYN Flood应当怎么处理;
拆包和粘包的问题, 如何解决, 如果我们的包没有固定长度的话, 我们的应用程序应该如何解决;
数据链路层是做什么的?
网络模型的分层, IP和Mac地址在那个层, TCP和HTTP分别在那个层;
TCP的同传, 拆包与组装包是什么意思;
两个不同ip地址的计算机之间如何通信;
-->

**对称加密与非对称加密**

对称密钥加密是指加密和解密使用同一个密钥的方式, 这种方式存在的最大问题就是密钥发送问题, 即如何安全地将密钥发给对方;
非对称加密是指使用一对非对称密钥, 即公钥和私钥, 公钥可以随意发布, 但私钥只有自己知道.发送密文的一方使用对方的公钥进行加密处理, 对方接收到加密信息后, 使用自己的私钥进行解密.

由于非对称加密的方式不需要发送用来解密的私钥, 所以可以保证安全性;但是和对称加密比起来, 它非常的慢, 所以我们还是要用对称加密来传送消息, 但对称加密所使用的密钥我们可以通过非对称加密的方式发送出去.

**DDoS攻击**

分布式拒绝服务攻击, 三次握手的最后一次不进行(不发送确认数据)从而使服务端一直处于等待的状态.
无法彻底解决, 预防方式有以下:
* 限制同时打开SYN半链接的数目
* 缩短SYN半链接的Time out 时间
* 关闭不必要的服务

**XSS攻击**

cross site script, 跨站脚本攻击
过于信任客户端提交的数据

反射性XSS攻击:攻击者注入的数据反映在响应中
持久性XSS攻击:XSS攻击代码存储在网站数据库

# 网络接口层

## 数据链路层

## 物理层


# tips

SNMP: 简单网络管理协议

# 参考

[计算机网络体系结构综述(上)](https://blog.csdn.net/justloveyou_/article/details/69611328)